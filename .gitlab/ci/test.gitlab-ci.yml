test:ubuntu:
  extends: 
    - .before_script_template
  stage: test
  tags:
    - ubuntu
  script:
    - make tests -j4
    - make test


test:python_api:
  stage: test
  tags:
    - ubuntu
  image: "python:3.7"
  script:
    - cd python
    - pip3.7 install virtualenv
    - python3.7 -m virtualenv venv
    - source venv/bin/activate
    - python3.7 --version
    - pip3.7 --version
    
    - pip3.7 install -r requirements.txt
    - pip3.7 install -r pytorch_interoperability/requirements.txt
    - pip3.7 install -r keras_interoperability/requirements.txt
    - pip3.7 freeze
    # Run on discovery all tests located in python/tests and discard the stdout 
    # only to show the errors/warnings and the results of the tests
    - python3.7 -m unittest discover -s tests -v -b 1> /dev/null 
