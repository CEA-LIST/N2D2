

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Introduction &mdash; N2D2  documentation</title>
  

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />

  
  
  
  

  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/language_data.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
        <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true, "ignoreClass": "document", "processClass": "math|output_area"}})</script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="Example" href="core/example.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home" alt="Documentation Home"> N2D2
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Introduction:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="intro/intro.html">Presentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="intro/about.html">About N2D2-IP</a></li>
<li class="toctree-l1"><a class="reference internal" href="intro/simus.html">Performing simulations</a></li>
<li class="toctree-l1"><a class="reference internal" href="intro/perfs_tools.html">Performance evaluation tools</a></li>
<li class="toctree-l1"><a class="reference internal" href="intro/tuto.html">Tutorials</a></li>
</ul>
<p class="caption"><span class="caption-text">ONNX Import:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="onnx/convert.html">Obtain ONNX models</a></li>
<li class="toctree-l1"><a class="reference internal" href="onnx/import.html">Import ONNX models</a></li>
<li class="toctree-l1"><a class="reference internal" href="onnx/transfer.html">Train from ONNX models</a></li>
</ul>
<p class="caption"><span class="caption-text">Quantization and Export:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="quant/post.html">Post-training quantization</a></li>
<li class="toctree-l1"><a class="reference internal" href="quant/qat.html">Quantization aware training</a></li>
<li class="toctree-l1"><a class="reference internal" href="export/CPP.html">Export: C++</a></li>
<li class="toctree-l1"><a class="reference internal" href="export/CPP_STM32.html">Export: C++/STM32</a></li>
<li class="toctree-l1"><a class="reference internal" href="export/TensorRT.html">Export: TensorRT</a></li>
<li class="toctree-l1"><a class="reference internal" href="export/DNeuro.html">Export: DNeuro</a></li>
<li class="toctree-l1"><a class="reference internal" href="export/legacy.html">Export: other / legacy</a></li>
</ul>
<p class="caption"><span class="caption-text">INI File Interface:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="ini/intro.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="ini/databases.html">Databases</a></li>
<li class="toctree-l1"><a class="reference internal" href="ini/data_analysis.html">Stimuli data analysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="ini/environment.html">Stimuli provider (Environment)</a></li>
<li class="toctree-l1"><a class="reference internal" href="ini/layers.html">Network Layers</a></li>
<li class="toctree-l1"><a class="reference internal" href="ini/target.html">Targets (outputs &amp; losses)</a></li>
</ul>
<p class="caption"><span class="caption-text">Python API:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="python_api/intro.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="python_api/databases.html">Databases</a></li>
<li class="toctree-l1"><a class="reference internal" href="python_api/cells.html">Cells</a></li>
<li class="toctree-l1"><a class="reference internal" href="python_api/tensor.html">Tensor</a></li>
<li class="toctree-l1"><a class="reference internal" href="python_api/deepnet.html">DeepNet</a></li>
<li class="toctree-l1"><a class="reference internal" href="python_api/interoperability.html">Interoperability</a></li>
<li class="toctree-l1"><a class="reference internal" href="python_api/example.html">Example</a></li>
</ul>
<p class="caption"><span class="caption-text">C++/Python core:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="core/intro.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="core/activations.html">Activation</a></li>
<li class="toctree-l1"><a class="reference internal" href="core/containers.html">Containers</a></li>
<li class="toctree-l1"><a class="reference internal" href="core/cells.html">Cells</a></li>
<li class="toctree-l1"><a class="reference internal" href="core/databases.html">Databases</a></li>
<li class="toctree-l1"><a class="reference internal" href="core/deepnet.html">DeepNet</a></li>
<li class="toctree-l1"><a class="reference internal" href="core/filler.html">Filler</a></li>
<li class="toctree-l1"><a class="reference internal" href="core/solver.html">Solver</a></li>
<li class="toctree-l1"><a class="reference internal" href="core/stimuliprovider.html">StimuliProvider</a></li>
<li class="toctree-l1"><a class="reference internal" href="core/transformation.html">Transformation</a></li>
<li class="toctree-l1"><a class="reference internal" href="core/target.html">Target</a></li>
<li class="toctree-l1"><a class="reference internal" href="core/example.html">Example</a></li>
</ul>
<p class="caption"><span class="caption-text">C++ API / Developer:</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">Introduction</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#the-cell-modules">The <code class="docutils literal notranslate"><span class="pre">Cell</span></code> modules</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#cell-class"><code class="docutils literal notranslate"><span class="pre">Cell</span></code> class</a></li>
<li class="toctree-l3"><a class="reference internal" href="#cell-frame-top-class"><code class="docutils literal notranslate"><span class="pre">Cell_Frame_Top</span></code> class</a></li>
<li class="toctree-l3"><a class="reference internal" href="#cell-frame-t-class"><code class="docutils literal notranslate"><span class="pre">Cell_Frame&lt;T&gt;</span></code> class</a></li>
<li class="toctree-l3"><a class="reference internal" href="#convcell-class"><code class="docutils literal notranslate"><span class="pre">ConvCell</span></code> class</a></li>
<li class="toctree-l3"><a class="reference internal" href="#convcell-frame-t-class"><code class="docutils literal notranslate"><span class="pre">ConvCell_Frame&lt;T&gt;</span></code> class</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#the-tensor-t-class">The <code class="docutils literal notranslate"><span class="pre">Tensor&lt;T&gt;</span></code> class</a></li>
</ul>
</li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">N2D2</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
        
      <li>Introduction</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/dev_intro.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  
<style>
/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast.container,
.nboutput.nblast.container {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast.container + .nbinput.container {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<div class="section" id="introduction">
<h1>Introduction<a class="headerlink" href="#introduction" title="Permalink to this headline">¶</a></h1>
<p>Welcome to the developer documentation. N2D2 is primarily developed in C++11 and
CUDA (for the GPU computing kernels). The library used internally for images processing is
OpenCV.</p>
<p>N2D2 is structured in module families, each family being defined by a base class,
for example <code class="docutils literal notranslate"><span class="pre">Database</span></code>, <code class="docutils literal notranslate"><span class="pre">Cell</span></code>, <code class="docutils literal notranslate"><span class="pre">Export</span></code>…
In this introduction, we will review the main N2D2 modules structure, which is
summarized in the figure below:</p>
<div class="figure align-default" id="id1">
<img alt="Main N2D2 modules." src="_images/N2D2_modules.png" />
<p class="caption"><span class="caption-text">Main N2D2 modules.</span><a class="headerlink" href="#id1" title="Permalink to this image">¶</a></p>
</div>
<div class="section" id="the-cell-modules">
<h2>The <code class="docutils literal notranslate"><span class="pre">Cell</span></code> modules<a class="headerlink" href="#the-cell-modules" title="Permalink to this headline">¶</a></h2>
<p>A <code class="docutils literal notranslate"><span class="pre">Cell</span></code> defines a layer / operator, constituting a base building block of a
neural network (or more generally a compute graph), like a convolution, a
pooling and so on.
The base <code class="docutils literal notranslate"><span class="pre">Cell</span></code> class is abstract and does not make any assumption on the
compute model, the data precision and even the coding of the data.</p>
<p>The class hierarchy for <code class="docutils literal notranslate"><span class="pre">Cell</span></code> is shown in the figure below. While it may
seem a bit complicated, it was designed this way to really separate different
notions:</p>
<ul class="simple">
<li><p><em>Mathematical model</em>: the actual mathematical function performed by the <code class="docutils literal notranslate"><span class="pre">Cell</span></code>,
regardless of the algorithm used for its implementation. For example,
<code class="docutils literal notranslate"><span class="pre">ConvCell</span></code> for a convolution, or <code class="docutils literal notranslate"><span class="pre">FcCell</span></code> for a fully connected layer
(or inner product);</p></li>
<li><p><em>Coding model</em>: the model used to code the data. <code class="docutils literal notranslate"><span class="pre">Frame</span></code> is for standard
tensor-based deep learning and <code class="docutils literal notranslate"><span class="pre">Spike</span></code> is for neuromorphic spike coding;</p></li>
<li><p><em>Programming model</em>: the programming model that will be used for the
implementation, meaning either plain C++ (with OpenMP) for CPU or CUDA for
GPU. Other programming model, like OpenCL, may be added in the future. When
there is only one programming model, the class hierarchy can be simplified
like for <code class="docutils literal notranslate"><span class="pre">Cell_Spike</span></code>. The <em>Programming model</em> class can be templated to
handle different data precision. For the <code class="docutils literal notranslate"><span class="pre">Cell_Frame&lt;T&gt;</span></code> and
<code class="docutils literal notranslate"><span class="pre">Cell_Frame_CUDA&lt;T&gt;</span></code> classes, <code class="docutils literal notranslate"><span class="pre">half</span></code>, <code class="docutils literal notranslate"><span class="pre">float</span></code> and <code class="docutils literal notranslate"><span class="pre">double</span></code> precision
are supported, but may not be implemented for every model (it is not mandatory
to provide implementation for every possible precision);</p></li>
<li><p><em>Implementation</em>: the actual implementation of the <em>Mathematical model</em>, using
the inherited <em>Coding model</em> and <em>Programming model</em>. The implementation
may use different algorithm to obtain the same <em>Mathematical model</em>, like
direct, GEMM or FFT algorithms for the convolution.</p></li>
</ul>
<div class="figure align-default" id="id2">
<img alt="``Cell`` modules class hierarchy." src="_images/Cell_hierarchy.png" />
<p class="caption"><span class="caption-text"><code class="docutils literal notranslate"><span class="pre">Cell</span></code> modules class hierarchy.</span><a class="headerlink" href="#id2" title="Permalink to this image">¶</a></p>
</div>
<div class="section" id="cell-class">
<h3><code class="docutils literal notranslate"><span class="pre">Cell</span></code> class<a class="headerlink" href="#cell-class" title="Permalink to this headline">¶</a></h3>
<p>The base <code class="docutils literal notranslate"><span class="pre">Cell</span></code> class only handles the topological information: the inputs
and outputs dimensions and virtual methods to connect the cells, among other.
The main methods are listed here:</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>doxygenclass: breathe_default_project value ‘N2D2’ does not seem to be a valid key for the breathe_projects dictionary</p>
</div>
<p>In order to create a computing graph, or neural network, cells can be connected
together thanks to the <code class="docutils literal notranslate"><span class="pre">addInput</span></code> method. An <code class="docutils literal notranslate"><span class="pre">Cell</span></code> can be connected to
another <code class="docutils literal notranslate"><span class="pre">Cell</span></code> or to a <code class="docutils literal notranslate"><span class="pre">StimuliProvider</span></code>, which constitute an entry point
for the data. It is up to the implementation to allow or not multiple inputs.
The <code class="docutils literal notranslate"><span class="pre">initialize</span></code> virtual member initializes the state of the <code class="docutils literal notranslate"><span class="pre">Cell</span></code> in the
implementation (initialization may be different depending on the coding or
programming model).</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>doxygenclass: breathe_default_project value ‘N2D2’ does not seem to be a valid key for the breathe_projects dictionary</p>
</div>
</div>
<div class="section" id="cell-frame-top-class">
<h3><code class="docutils literal notranslate"><span class="pre">Cell_Frame_Top</span></code> class<a class="headerlink" href="#cell-frame-top-class" title="Permalink to this headline">¶</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">Cell_Frame_Top</span></code> is a purely abstract class, which does not inherit from
the <code class="docutils literal notranslate"><span class="pre">Cell</span></code> class. It provides
all the actual interface for a given <em>Coding model</em>. For the <code class="docutils literal notranslate"><span class="pre">Frame</span></code> coding
model, the input/output data is a Nd-tensor. This coding model is also
“bi-directional”, as it supports differentiation, thus its interface comprise
a forward data path and backward data path for the gradient. It is however not
mandatory for the implementation to handle the backward path, for non-differentiable
cells for example.</p>
<p>The main interfaces provided by <code class="docutils literal notranslate"><span class="pre">Cell_Frame_Top</span></code> are listed below:</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>doxygenclass: breathe_default_project value ‘N2D2’ does not seem to be a valid key for the breathe_projects dictionary</p>
</div>
<p>This class also handles the <code class="docutils literal notranslate"><span class="pre">Activation</span></code> and contains the shared pointer to
the <code class="docutils literal notranslate"><span class="pre">Activation</span></code> object to use.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>doxygenclass: breathe_default_project value ‘N2D2’ does not seem to be a valid key for the breathe_projects dictionary</p>
</div>
</div>
<div class="section" id="cell-frame-t-class">
<h3><code class="docutils literal notranslate"><span class="pre">Cell_Frame&lt;T&gt;</span></code> class<a class="headerlink" href="#cell-frame-t-class" title="Permalink to this headline">¶</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">Cell_Frame&lt;T&gt;</span></code> inherits from <code class="docutils literal notranslate"><span class="pre">Cell</span></code> and <code class="docutils literal notranslate"><span class="pre">Cell_Frame_Top</span></code>. It contains
the output tensors and input tensor references.
<code class="docutils literal notranslate"><span class="pre">Cell_Frame&lt;T&gt;</span></code> should not provide more members than <code class="docutils literal notranslate"><span class="pre">Cell_Frame_Top</span></code> already does.</p>
<div class="figure align-default" id="id3">
<img alt="``Cell_Frame&lt;T&gt;`` interface." src="_images/Cell_Frame_interface.png" />
<p class="caption"><span class="caption-text"><code class="docutils literal notranslate"><span class="pre">Cell_Frame&lt;T&gt;</span></code> interface.</span><a class="headerlink" href="#id3" title="Permalink to this image">¶</a></p>
</div>
</div>
<div class="section" id="convcell-class">
<h3><code class="docutils literal notranslate"><span class="pre">ConvCell</span></code> class<a class="headerlink" href="#convcell-class" title="Permalink to this headline">¶</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">ConvCell</span></code> class (or any other model) provides additional interfaces to
the base <code class="docutils literal notranslate"><span class="pre">Cell</span></code> class that it inherits, specific to the <em>Mathematical model</em>
it represents, regardless of the <em>Coding model</em>. For a convolution for example,
getter and setter members are provided for the weights, but also references to
<code class="docutils literal notranslate"><span class="pre">Filler</span></code> and <code class="docutils literal notranslate"><span class="pre">Solver</span></code> for the weights. Some facilities may be specific to
a particular coding model. The data structure (tensor) containing the weights
is however not defined in this class, but in the implementation
(<code class="docutils literal notranslate"><span class="pre">ConvCell_Frame</span></code>), because it can depend on the programming model and data
precision.</p>
<p>The main members (for <code class="docutils literal notranslate"><span class="pre">ConvCell</span></code>) are:</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>doxygenclass: breathe_default_project value ‘N2D2’ does not seem to be a valid key for the breathe_projects dictionary</p>
</div>
</div>
<div class="section" id="convcell-frame-t-class">
<h3><code class="docutils literal notranslate"><span class="pre">ConvCell_Frame&lt;T&gt;</span></code> class<a class="headerlink" href="#convcell-frame-t-class" title="Permalink to this headline">¶</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">ConvCell_Frame&lt;T&gt;</span></code> is the final class implementing the convolution
<em>Mathematical model</em> with the tensor-based <code class="docutils literal notranslate"><span class="pre">Frame</span></code> <em>Coding model</em> on standard
C++ for CPU <em>Programming model</em>. It is only an implementation class, which
therefore does not provide any new members.</p>
</div>
</div>
<div class="section" id="the-tensor-t-class">
<h2>The <code class="docutils literal notranslate"><span class="pre">Tensor&lt;T&gt;</span></code> class<a class="headerlink" href="#the-tensor-t-class" title="Permalink to this headline">¶</a></h2>
<p>The <code class="docutils literal notranslate"><span class="pre">Tensor&lt;T&gt;</span></code> class is the base data structure in N2D2, a Nd-tensor. In
N2D2, a tensor has the following properties:</p>
<ul class="simple">
<li><p>Its data is guaranteed to be <strong>continuous</strong>. It therefore does not handle
arbitrary strides without actual data reorganization. While this property
may appear restricting, it is an assumed design choice to simplify the
implementation of the many possible coding and programming models;</p></li>
<li><p>It <strong>holds a reference</strong> to the data, meaning no data is actually copied in a
tensor assignment and the new tensor will point to the same data. To perform
an actual copy, the <code class="docutils literal notranslate"><span class="pre">clone()</span></code> method should be used;</p></li>
<li><p>It is <strong>explicitly typed</strong>, meaning that the data type is part of the tensor
type, as a template parameter. When the type does not need to be known or can
be arbitrary, a reference to the <code class="docutils literal notranslate"><span class="pre">BaseTensor</span></code> base class should be used.
Conversion from one tensor type (or from a <code class="docutils literal notranslate"><span class="pre">BaseTensor</span></code> reference) to another
can be performed with the <code class="docutils literal notranslate"><span class="pre">tensor_cast&lt;T&gt;()</span></code> function;</p></li>
<li><p>Down to <strong>zero overhead</strong> type conversion. Memory is only allocated once
for a given type conversion during the lifetime of the tensor.
Type conversion can be made without any data copy-conversion,
with the <code class="docutils literal notranslate"><span class="pre">tensor_cast_nocopy&lt;T&gt;()</span></code> function, when it is known that a previous
conversion is still valid, thus incurring zero overhead.</p></li>
</ul>
<p>The <code class="docutils literal notranslate"><span class="pre">Tensor&lt;T&gt;</span></code> implementation classes hierarchy is shown in the figure below.</p>
<div class="figure align-default" id="id4">
<img alt="``Tensor&lt;T&gt;`` implementation classes hierarchy." src="_images/Tensor_diagram.png" />
<p class="caption"><span class="caption-text"><code class="docutils literal notranslate"><span class="pre">Tensor&lt;T&gt;</span></code> implementation classes hierarchy.</span><a class="headerlink" href="#id4" title="Permalink to this image">¶</a></p>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
      
        <a href="core/example.html" class="btn btn-neutral float-left" title="Example" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        
        &copy; Copyright 2019, CEA LIST

    </p>
  </div>
    
    
    
    Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>